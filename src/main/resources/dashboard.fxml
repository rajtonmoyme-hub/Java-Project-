<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.SVGPath?>
<?import javafx.scene.shape.Circle?>
<?import java.net.URL?>

<BorderPane prefHeight="900.0" prefWidth="1400.0" styleClass="dashboard-root" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.example.foodprice.DashboardController">

    <!-- CSS Links -->
    <stylesheets>
        <URL value="@css/sidebar.css" />
        <URL value="@css/dashboard.css" />
    </stylesheets>

    <!-- LEFT SIDEBAR -->
    <left>
        <fx:include source="sidebar.fxml" />
    </left>

    <!-- MAIN CONTENT -->
    <center>
        <ScrollPane fitToWidth="true" styleClass="main-scroll">
            <VBox spacing="25">
                <padding><Insets top="20" right="30" bottom="30" left="30" /></padding>

                <!-- Top Search & Profile Bar -->
                <HBox alignment="CENTER_LEFT" spacing="20">
                    <HBox alignment="CENTER_LEFT" spacing="10" styleClass="search-bar" HBox.hgrow="ALWAYS">
                        <SVGPath content="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="#94A3B8" scaleX="0.8" scaleY="0.8"/>
                        <TextField promptText="অনুসন্ধান করুন..." style="-fx-background-color: transparent;" HBox.hgrow="ALWAYS"/>
                    </HBox>
                    <StackPane styleClass="icon-btn"><SVGPath content="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z" fill="#64748B"/></StackPane>
                    <StackPane styleClass="icon-btn"><SVGPath content="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.56-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .43-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.49-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" fill="#64748B"/></StackPane>
                </HBox>

                <!-- GREEN BANNER -->
                <HBox styleClass="green-banner" alignment="CENTER_LEFT">
                    <StackPane styleClass="banner-icon-bg">
                        <SVGPath content="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" fill="#10B981" scaleX="1.2" scaleY="1.2"/>
                    </StackPane>
                    <VBox spacing="2">
                        <Label text="ড্যাশবোর্ড" styleClass="banner-title"/>
                        <Label fx:id="lblBannerDate" text="-" styleClass="banner-date"/>
                    </VBox>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button text="↻ রিফ্রেশ করুন" styleClass="btn-refresh" onAction="#handleRefresh"/>
                </HBox>

                <!-- TOP 5 STAT CARDS -->
                <HBox spacing="20">
                    <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <HBox alignment="CENTER_LEFT"><StackPane styleClass="icon-bg-green"><SVGPath content="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9z" fill="#10B981"/></StackPane><Region HBox.hgrow="ALWAYS"/><Label fx:id="lblProductsTrend" text="-" styleClass="trend-up"/></HBox>
                        <Label text="মোট পণ্য" styleClass="stat-label"/>
                        <Label fx:id="lblTotalProducts" text="১০" styleClass="stat-value"/>
                        <Label text="গত মাসের তুলনায়" styleClass="stat-sub"/>
                    </VBox>

                    <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <HBox alignment="CENTER_LEFT"><StackPane styleClass="icon-bg-blue"><SVGPath content="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" fill="#3B82F6"/></StackPane><Region HBox.hgrow="ALWAYS"/><Label fx:id="lblFarmersTrend" text="-" styleClass="trend-up"/></HBox>
                        <Label text="মোট কৃষক" styleClass="stat-label"/>
                        <Label fx:id="lblFarmerCount" text="৮" styleClass="stat-value"/>
                        <Label text="গত মাসের তুলনায়" styleClass="stat-sub"/>
                    </VBox>

                    <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <HBox alignment="CENTER_LEFT"><StackPane styleClass="icon-bg-teal"><SVGPath content="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-6l-2-2z" fill="#14B8A6"/></StackPane><Region HBox.hgrow="ALWAYS"/></HBox>
                        <Label text="মোট গুদাম" styleClass="stat-label"/>
                        <Label fx:id="lblTotalWarehouses" text="৬" styleClass="stat-value"/>
                    </VBox>

                    <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <HBox alignment="CENTER_LEFT"><StackPane styleClass="icon-bg-orange"><SVGPath content="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.31-8.86c-1.77-.45-2.34-.94-2.34-1.67 0-.84.79-1.43 2.1-1.43 1.38 0 1.9.66 1.94 1.64h1.71c-.05-1.34-.87-2.57-2.49-2.97V5H10.9v1.69c-1.51.32-2.72 1.3-2.72 2.81 0 1.79 1.49 2.69 3.66 3.21 1.95.46 2.34 1.15 2.34 1.87 0 .53-.39 1.64-2.25 1.64-1.74 0-2.32-.96-2.39-1.8H7.79c.08 1.55 1.05 2.76 2.86 3.12V19h1.8v-1.65c1.69-.36 2.82-1.46 2.82-2.98 0-2.23-1.66-2.99-3.23-3.51z" fill="#F59E0B"/></StackPane><Region HBox.hgrow="ALWAYS"/><Label fx:id="lblStockTrend" text="-" styleClass="trend-down"/></HBox>
                        <Label text="মোট মজুদ" styleClass="stat-label"/>
                        <HBox alignment="BASELINE_LEFT" spacing="5"><Label fx:id="lblTotalStock" text="৪,০৩৫" styleClass="stat-value"/><Label text="MT" styleClass="stat-sub"/></HBox>
                        <Label text="গত সপ্তাহের তুলনায়" styleClass="stat-sub"/>
                    </VBox>

                    <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <HBox alignment="CENTER_LEFT"><StackPane styleClass="icon-bg-red"><SVGPath content="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" fill="#EF4444"/></StackPane><Region HBox.hgrow="ALWAYS"/></HBox>
                        <Label text="ঝুঁকিপূর্ণ পণ্য" styleClass="stat-label"/>
                        <Label fx:id="lblRiskProducts" text="0" styleClass="stat-value"/>
                    </VBox>
                </HBox>

                <!-- MIDDLE SECTION (Chart & Quick Actions) -->
                <HBox spacing="20">
                    <!-- Left Bar Chart -->
                    <VBox styleClass="content-card" HBox.hgrow="ALWAYS">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <SVGPath content="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="#3B82F6"/>
                            <Label text="অঞ্চলভিত্তিক মজুদ বিতরণ" styleClass="card-title"/>
                        </HBox>
                        <BarChart fx:id="regionChart" legendVisible="false" prefHeight="250" styleClass="region-chart">
                            <xAxis><CategoryAxis/></xAxis>
                            <yAxis><NumberAxis/></yAxis>
                        </BarChart>
                    </VBox>

                    <!-- Right Quick Actions -->
                    <VBox styleClass="content-card" prefWidth="350" spacing="15">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <SVGPath content="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="#10B981"/>
                            <Label text="দ্রুত কার্যক্রম" styleClass="card-title"/>
                        </HBox>
                        <GridPane hgap="10" vgap="10">
                            <columnConstraints><ColumnConstraints percentWidth="50"/><ColumnConstraints percentWidth="50"/></columnConstraints>
                            <Button fx:id="btnQuickAddProduct" styleClass="action-btn" text="পণ্য যোগ করুন" onAction="#quickAddProduct" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                <graphic><StackPane styleClass="action-icon, bg-green"><SVGPath content="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2z" fill="white"/></StackPane></graphic>
                            </Button>
                            <Button fx:id="btnQuickAddFarmer" styleClass="action-btn" text="কৃষক যোগ করুন" onAction="#quickAddFarmer" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                <graphic><StackPane styleClass="action-icon, bg-blue"><SVGPath content="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" fill="white"/></StackPane></graphic>
                            </Button>
                            <Button fx:id="btnQuickAddWarehouse" styleClass="action-btn" text="গুদাম যোগ করুন" onAction="#quickAddWarehouse" GridPane.columnIndex="0" GridPane.rowIndex="1">
                                <graphic><StackPane styleClass="action-icon, bg-purple"><SVGPath content="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-6l-2-2z" fill="white"/></StackPane></graphic>
                            </Button>
                            <Button fx:id="btnQuickImportRecord" styleClass="action-btn" text="আমদানি রেকর্ড" onAction="#goToImport" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                <graphic><StackPane styleClass="action-icon, bg-teal"><SVGPath content="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" fill="white"/></StackPane></graphic>
                            </Button>
                        </GridPane>
                    </VBox>
                </HBox>

                <!-- BOTTOM SECTION -->
                <HBox spacing="20">
                    <!-- Left Table -->
                    <VBox styleClass="content-card" HBox.hgrow="ALWAYS" spacing="15">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <SVGPath content="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" fill="#3B82F6"/>
                            <Label text="সাম্প্রতিক আমদানি" styleClass="card-title"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label text="সব দেখুন ↗" styleClass="text-link"/>
                        </HBox>
                        <!-- Table Header -->
                        <HBox styleClass="table-header">
                            <Label text="রেকর্ড আইডি" prefWidth="120"/>
                            <Label text="পণ্য" prefWidth="100"/>
                            <Label text="পরিমাণ" prefWidth="100"/>
                            <Label text="উৎস" prefWidth="100"/>
                            <Label text="তারিখ" prefWidth="120"/>
                            <Label text="অবস্থা"/>
                        </HBox>
                        <VBox fx:id="importListContainer" spacing="10"/>
                    </VBox>

                    <!-- Right Risk Alerts -->
                    <VBox styleClass="content-card" prefWidth="350" spacing="15">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <SVGPath content="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" fill="#EF4444"/>
                            <Label text="ঝুঁকি সতর্কতা" styleClass="card-title"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="lblRiskBadge" text="0" styleClass="badge-red-circle"/>
                        </HBox>
                        <VBox fx:id="alertListContainer" spacing="10"/>
                    </VBox>
                </HBox>

                <!-- Warehouse Progress Bars -->
                <VBox styleClass="content-card" spacing="15">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <SVGPath content="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-6l-2-2z" fill="#10B981"/>
                        <Label text="গুদাম ধারণক্ষমতা" styleClass="card-title"/>
                    </HBox>
                    <VBox fx:id="warehouseProgressContainer" spacing="12"/>
                </VBox>

            </VBox>
        </ScrollPane>
    </center>
</BorderPane>
